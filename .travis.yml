sudo: required

git:
  depth: 3

language: rust
rust:
  - stable
#  - beta

#matrix:
#  allow_failures:
#    - rust:
#        - beta
#  fast_finish: true

#cache:
# - cargo

notifications:
  email: false

# Before install, bump the required version of LLVM
before-install:
  - sudo apt-get -qq update
  - sudo sh -c "echo 'deb http://llvm.org/apt/precise/ llvm-toolchain-precise-3.7 main' >> /etc/apt/sources.list"
  - sudo sh -c "echo 'deb http://llvm.org/apt/precise/ llvm-toolchain-precise main' >> /etc/apt/sources.list"
  - wget -O - http://llvm.org/apt/llvm-snapshot.gpg.key | sudo apt-key add -
  - sudo add-apt-repository --yes ppa:ubuntu-toolchain-r/test
  - sudo apt-get -qq update

install:
 - cargo install --force cargo-check
 - sudo apt-get install -y llvm-3.7 llvm-3.7-dev llvm-3.7-runtime llvm-3.7-tool

script:
  - llvm-config --version
  - cargo check --verbose
  - cargo test --verbose --no-run
